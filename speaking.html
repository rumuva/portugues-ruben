<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Speaking — INGLÉS RUBÉN</title>
  <meta name="theme-color" content="#0ea5e9"><link rel="icon" href="assets/img/logo-ruben.png">
  <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>
<header><div class="wrap top"><a href="index.html" class="brand"><img src="assets/img/logo-ruben.png" alt="Logo"><strong>INGLÉS RUBÉN</strong></a><nav>
  <a href="grammar-vocabulary.html">Grammar&Vocab</a><a href="reading.html">Reading</a><a href="listening.html">Listening</a><a href="writing.html">Writing</a>
  <a href="speaking.html" class="active">Speaking</a>
  <a href="plan-estudio.html">Plan</a><a href="simulacros.html">Simulacros</a>
  <a href="extras.html">Extras</a><a href="mis-resultados.html">Mis Resultados</a>
  <a href="contacto.html">Contacto</a>
</nav></div></header>

<section class="wrap">
  <h1>Speaking</h1>
  <p>Prompts reales por partes (1–4) y respuestas modelo. Puedes grabarte con la grabadora integrada del navegador (permite comparar).</p>
  <div class="card">
    <h2>Speaking Prompts</h2>
    <div id="speaking-prompts"></div>
  </div>
  <div class="card">
    <h2>Grabadora sencilla</h2>
    <p><small>Da permisos al navegador. Puedes descargar tu audio.</small></p>
    <div style="display:flex;gap:8px;flex-wrap:wrap">
      <button class="btn" id="rec-start" type="button">Grabar</button>
      <button class="btn ghost" id="rec-stop" type="button">Detener</button>
    </div>
    <audio id="rec-audio" controls style="margin-top:8px;width:100%"></audio>
  </div>
</section>

<footer><div class="wrap foot"><div class="foot-left"><img src="assets/img/logo-ruben.png" alt="Logo"><small>© 2025 INGLÉS RUBÉN</small></div><small>Aptis General — A0→B2</small></div></footer>
<script src="assets/js/app.js"></script>
<script src="assets/js/data-speaking.js"></script>
<script>
  (function(){
    const host = document.getElementById('speaking-prompts');
    speakingPrompts.forEach(s => {
      const d = document.createElement('details');
      d.innerHTML = `
        <summary><b>${s.part}</b></summary>
        <p><b>Prompts:</b></p>
        <ul>${s.prompts.map(p=>`<li>${p}</li>`).join('')}</ul>
        <p><b>Modelo B2:</b></p>
        <ul>${s.model.map(m=>`<li>${m}</li>`).join('')}</ul>
      `;
      host.appendChild(d);
    });
  })();

  (function(){
    let mediaRecorder, chunks=[];
    const btnS = document.getElementById('rec-start');
    const btnT = document.getElementById('rec-stop');
    const audio = document.getElementById('rec-audio');
    async function start(){
      const stream = await navigator.mediaDevices.getUserMedia({audio:true});
      mediaRecorder = new MediaRecorder(stream);
      chunks = [];
      mediaRecorder.ondataavailable = e=>chunks.push(e.data);
      mediaRecorder.onstop = ()=>{
        const blob = new Blob(chunks,{type:'audio/webm'});
        audio.src = URL.createObjectURL(blob);
      };
      mediaRecorder.start();
    }
    function stop(){ if(mediaRecorder && mediaRecorder.state!=='inactive') mediaRecorder.stop(); }
    btnS.addEventListener('click', start);
    btnT.addEventListener('click', stop);
  })();
</script>
</body></html>
